# Node Manager 使用说明

> 本文档面向首次使用的用户，手把手教你管理住宅代理节点。

---

## 1. 安装插件

将 IPK 文件传到路由器后，通过 SSH 执行：

```bash
opkg install /tmp/luci-app-nodemanager_*.ipk
```

安装完成后，打开浏览器访问路由器管理页面，在 **服务 → Node Manager** 中即可看到插件。

---

## 2. 页面介绍

插件有 4 个页面：

| 页面 | 用途 |
|------|------|
| **Proxies** | 管理代理节点（最常用） |
| **Providers** | 管理机场订阅 |
| **DNS** | 管理 DNS 服务器 |
| **About** | 关于我们 |

---

## 3. 添加代理节点

### 方式一：手动添加

1. 点击 **➕ 添加** 按钮
2. 填写节点信息：
   - **名称**：留空会自动生成（NM-001, NM-002…）
   - **类型**：socks5 或 http
   - **服务器**：代理服务器地址
   - **端口**：代理端口号
   - **用户名/密码**：如果需要认证
3. 点击 **💾 保存**

### 方式二：批量导入

1. 点击 **📥 导入** 按钮
2. 粘贴节点信息（支持多种格式，直接粘贴不用选格式）：

```
# 最简单的格式：一行一个
1.2.3.4:1080
user:pass@5.6.7.8:1080

# URL 格式
socks5://user:pass@1.2.3.4:1080#美国节点
```

3. 点击导入，检查识别结果
4. 点击 **💾 保存**

---

## 4. 绑定设备 IP

每个节点可以绑定一个或多个设备 IP，让指定设备的流量走指定节点。

在 **Bind IPs** 列中输入 IP，多个用逗号分隔：

| 输入 | 效果 |
|------|------|
| `192.168.8.101` | 这台设备走此节点 |
| `192.168.8.0` | 整个子网走此节点（自动识别为 /24） |
| `192.168.8.0/24` | 同上，显式写法 |
| `192.168.8.101, 192.168.8.102` | 两台设备走此节点 |

填好后点击 **💾 保存**。

---

## 5. 管理机场订阅

切换到 **Providers** 页面：

1. 填写订阅地址（URL）
2. 设置自动更新间隔
3. 点击保存

机场节点会作为单独的 proxy-provider 加载，不会与手动节点冲突。

---

## 6. DNS 管理

切换到 **DNS** 页面，可以管理不同类别的 DNS 服务器：

- **nameserver**：主 DNS
- **default-nameserver**：引导 DNS（用于解析 DoH 地址）
- **proxy-server-nameserver**：代理服务器专用 DNS
- **nameserver-policy**：按域名指定 DNS

每个分类可以添加多个 DNS 地址，支持：
- 普通 DNS：`8.8.8.8`
- DoH：`https://dns.google/dns-query`
- DoT：`tls://dns.google`

点击 ⚡ 按钮可以测试 DNS 连通性。

---

## 7. 导出备份

在 Proxies 页面点击 **📤 导出**，会下载一个 JSON 文件，包含所有节点配置。

可以用这个文件在另一台路由器上导入恢复。

---

## 8. 测速

点击节点行的 **⚡** 按钮可以测试单个节点延迟，或使用工具栏的测速按钮批量测试。

---

## 9. 常见问题

**Q: 保存后需要重启 Mihomo 吗？**
A: 是的，保存配置后需要在状态栏点击 **🔄 重启** 按钮让新配置生效。

**Q: 什么是前置节点（dialer-proxy）？**
A: 流量先经过前置节点（如 VPS），再到达住宅代理。插件会自动从你的配置中读取前置节点设置，不需要手动配置。

**Q: 最多能管理多少节点？**
A: 没有硬性限制。200+ 节点经过优化，无性能问题。

**Q: 导入格式不确定怎么办？**
A: 直接粘贴，插件会自动识别格式（JSON / YAML / URL / 文本都支持）。
