# Node Manager 使用说明

> 本文档面向首次接触的新手用户，帮助你快速上手管理住宅代理节点。  
> 所有操作都在路由器的网页管理后台完成，不需要任何命令行知识。

---

## 目录

1. [安装插件](#1-安装插件)
2. [找到插件入口](#2-找到插件入口)
3. [认识界面](#3-认识界面)
4. [查看运行状态](#4-查看运行状态)
5. [添加代理节点](#5-添加代理节点)
6. [批量导入节点](#6-批量导入节点)
7. [编辑和删除节点](#7-编辑和删除节点)
8. [调整节点顺序（拖拽排序）](#8-调整节点顺序拖拽排序)
9. [绑定设备 IP](#9-绑定设备-ip)
10. [测试节点速度](#10-测试节点速度)
11. [导出备份](#11-导出备份)
12. [管理机场订阅](#12-管理机场订阅)
13. [管理 DNS 服务器](#13-管理-dns-服务器)
14. [常见问题](#14-常见问题)

---

## 1. 安装插件

### 准备工作

你需要准备好以下东西：

- 一台已刷好 ImmortalWrt 系统的路由器（24.10 或更高版本）
- 路由器上已安装好 Mihomo（也叫 nikki）
- 插件安装包文件（文件名类似 `luci-app-nodemanager_xxx.ipk`）

### 安装步骤

1. 打开电脑浏览器，在地址栏输入路由器的管理地址（一般是 `192.168.8.1`），然后输入密码登录
2. 在顶部菜单栏找到 **系统 → Software（软件包）**
3. 点击页面中的 **上传软件包（Upload Package）** 按钮
4. 在弹出的窗口中，选择你下载好的 `.ipk` 安装包文件
5. 点击 **安装（Install）** 按钮，等待安装完成
6. 安装完成后，**刷新一下浏览器页面**（按 `Ctrl + F5` 或 `Cmd + Shift + R`），新菜单就会出现

> 💡 **小提示**：如果安装后菜单没有出现，试试退出登录后重新登录，或者清除浏览器缓存后再刷新。

---

## 2. 找到插件入口

安装成功后，在路由器管理页面的顶部菜单栏中：

**服务 → Node Manager**

点进去就能看到插件界面了。

---

## 3. 认识界面

插件一共有 **4 个页面**，可以通过顶部的标签页切换：

| 页面 | 作用 | 简单说明 |
|------|------|---------|
| **Proxies**（节点管理） | 管理你的代理节点 | 最常用的页面，添加、编辑、删除、测速都在这里 |
| **Providers**（机场订阅） | 管理机场订阅地址 | 如果你有机场订阅链接，在这里添加 |
| **DNS** | 管理域名解析服务器 | 一般不需要修改 |
| **About**（关于） | 关于我们 | 显示项目信息和联系方式 |

---

## 4. 查看运行状态

每个页面的顶部都有一个 **状态栏**，显示底层代理服务（nikki / Mihomo）的运行状态：

| 状态 | 含义 |
|------|------|
| 🟢 **nikki running** | 代理服务正在运行，一切正常 |
| 🔴 **nikki stopped** | 代理服务已停止，节点不会生效 |

状态栏右侧有一个按钮：

- 代理服务**运行中**时，按钮显示 **Restart（重启）** —— 修改配置后需要点这个按钮让新配置生效
- 代理服务**已停止**时，按钮显示 **Start（启动）** —— 点击启动代理服务

> ⚠️ **重要提醒**：每次**保存**配置后，都需要点击 **重启** 按钮，新的配置才会真正生效！

---

## 5. 添加代理节点

进入 **Proxies** 页面，你会看到一个表格和一排工具按钮。

### 手动添加一个节点

1. 点击工具栏的 **➕ Add（添加）** 按钮
2. 页面底部会出现一行空白的新节点，光标会自动定位到名称栏
3. 填写以下信息：

| 栏目 | 必填？ | 说明 |
|------|--------|------|
| **Name**（名称） | 可选 | 给这个节点起个名字，比如"美国01"。留空的话系统会自动起名（NM-001, NM-002…） |
| **Server**（服务器地址） | ✅ 必填 | 代理服务器的地址，比如 `1.2.3.4` 或者 `example.com`|
| **Port**（端口） | ✅ 必填 | 代理服务的端口号，比如 `1080` |
| **Username**（用户名） | 可选 | 如果代理需要登录验证，填写用户名 |
| **Password**（密码） | 可选 | 如果代理需要登录验证，填写密码。密码默认以圆点显示，点击旁边的 👁 图标可以切换显示/隐藏 |
| **Bind IPs**（绑定 IP） | 可选 | 指定哪些设备走这个节点，后面会详细说明 |

4. 填好后，点击 **💾 Save（保存）** 按钮
5. 最后别忘了点状态栏的 **Restart（重启）** 让配置生效

---

## 6. 批量导入节点

如果你有很多节点需要添加，一个个手动填太麻烦了。你可以使用**批量导入**功能，一次性导入多个节点。

### 导入步骤

1. 点击工具栏的 **📥 Import（导入）** 按钮
2. 弹出一个导入窗口，你有两种方式提供节点信息：

   **方式 A：直接粘贴文本**
   
   把节点信息直接粘贴到大文本框里。插件会**自动识别格式**，你不用管是什么格式，直接粘贴就行。

   **方式 B：选择文件**
   
   如果你有一个节点配置文件（`.json`、`.txt`、`.yaml`、`.yml` 都行），点击文本框下面的**选择文件**按钮来导入。

3. 选择导入模式：
   - **追加到现有节点**（默认）：新导入的节点会添加到已有节点的后面
   - **替换现有节点**：清空所有现有节点，只保留新导入的

4. 点击 **Import（导入）** 按钮
5. 检查导入结果是否正确
6. 确认无误后，点击 **💾 Save（保存）**
7. 最后点状态栏的 **Restart（重启）** 让配置生效

### 支持的导入格式

你不用记住这些格式，直接粘贴就好，插件会自动识别：

**格式一：最简单的一行一个**

```
1.2.3.4:1080
5.6.7.8:1080
```

**格式二：带用户名密码**

```
user:pass@1.2.3.4:1080
admin:123456@5.6.7.8:1080
```

**格式三：带名称（用 # 号标注）**

```
1.2.3.4:1080 # 美国节点
5.6.7.8:1080 # 日本节点
```

**格式四：URL 链接格式**

```
socks5://user:pass@1.2.3.4:1080#美国节点
http://user:pass@5.6.7.8:8080#日本节点
```

**格式五：JSON 格式**

```json
[
  {"name": "美国01", "type": "socks5", "server": "1.2.3.4", "port": 1080, "username": "user", "password": "pass"},
  {"name": "日本01", "type": "socks5", "server": "5.6.7.8", "port": 1080}
]
```

**格式六：YAML 格式（常见于 Clash 配置）**

```yaml
- {name: 美国01, type: socks5, server: 1.2.3.4, port: 1080, username: user, password: pass}
- {name: 日本01, type: socks5, server: 5.6.7.8, port: 1080}
```

> 💡 **提示**：单次导入最多支持 **500 个节点**。

---

## 7. 编辑和删除节点

### 编辑节点

直接在表格中点击你想修改的字段，修改完成后点击 **💾 Save（保存）**。

### 删除单个节点

点击节点行右侧的 **🗑️** 删除按钮，确认后该节点会被移除。

### 批量删除多个节点

1. 通过每行左侧的 **☑ 勾选框** 选中你要删除的节点
   - 想全选当前页所有节点？点击表头的全选勾选框即可
2. 选好后，工具栏的 **🗑️ Batch Delete（批量删除）** 按钮会变为可用状态，并且会显示已选中的数量
3. 点击 **🗑️ Batch Delete** 按钮，确认删除

> ⚠️ 删除后记得点 **💾 Save（保存）** ，否则刷新页面后被删除的节点又会回来。

---

## 8. 调整节点顺序（拖拽排序）

你可以通过拖拽来调整节点的前后顺序：

1. 用鼠标按住节点行左侧的 **☰** 拖拽手柄
2. 按住不放，上下移动鼠标
3. 松开鼠标，节点就会被放到新的位置

> 💡 只有 **☰** 图标可以拖拽，点击其他地方不会触发拖拽，所以不会影响你编辑文字。
>
> 调整顺序后记得点 **💾 Save（保存）**。

---

## 9. 绑定设备 IP

这个功能可以让你指定某台设备（电脑、手机等）的上网流量通过某个特定的代理节点。

### 怎么用

在节点行的 **Bind IPs** 栏中输入设备的 IP 地址，多个设备用**英文逗号**隔开。

### 示例

| 输入 | 效果 |
|------|------|
| `192.168.5.101` | 这一台设备的流量走此节点 |
| `192.168.5.101, 192.168.5.102` | 这两台设备的流量都走此节点 |
| `192.168.5.0` | 整个 192.168.5.x 网段的所有设备都走此节点（系统会自动识别为一个子网） |

### 怎么找到设备的 IP 地址？

- **方法一**：在路由器管理页面的首页或状态页面，通常可以看到所有已连接设备的 IP 地址
- **方法二**：在设备上查看：
  - Windows：打开命令提示符，输入 `ipconfig`
  - Mac：打开系统设置 → 网络
  - 手机：在 Wi-Fi 设置中查看

> 填好后记得点 **💾 Save（保存）**，再点 **Restart（重启）** 生效。

---

## 10. 测试节点速度

在使用节点之前，可以先测试一下节点的连通性和速度。

### 测试单个节点

点击节点行右侧的 **⚡** 按钮，等待几秒钟，会显示延迟时间：

| 显示颜色 | 含义 |
|---------|------|
| 🟢 绿色数字（例如 `120ms`） | 速度很好 |
| 🟡 黄色数字（例如 `350ms`） | 速度一般 |
| 🔴 红色数字或 `Timeout` | 连接慢或连不上 |

### 测试所有节点

点击工具栏的 **⚡ Test All（全部测试）** 按钮，系统会逐个测试所有节点。测试过程中按钮会显示进度（例如 `⚡ 5/20`）。

> ⚠️ 测速功能需要在代理服务**运行中**时才能使用（状态栏显示 🟢）。如果服务未运行，测速按钮会变灰、无法点击。

---

## 11. 导出备份

你可以把当前所有节点导出保存，方便备份或者迁移到另一台路由器。

1. 点击工具栏的 **📤 Export（导出）** 按钮
2. 浏览器会自动下载一个名为 `nodemanager-proxies.json` 的文件
3. 这个文件包含了你所有节点的信息（名称、地址、端口、用户名、密码等）

### 怎么恢复备份？

在另一台路由器上安装好插件后，用**导入**功能（参看[第 6 节](#6-批量导入节点)），选择之前导出的 JSON 文件，选择"替换现有节点"导入即可。

---

## 12. 管理机场订阅

如果你使用的是"机场"服务（提供订阅链接的代理服务商），可以在 **Providers** 页面管理订阅。

### 添加订阅

1. 切换到 **Providers** 标签页
2. 点击 **➕ Add（添加）** 按钮
3. 填写以下信息：
   - **Provider Name**（订阅名称）：随便起个名字，比如 `我的机场`
   - **Subscription URL**（订阅地址）：粘贴机场提供给你的订阅链接
4. 点击 **💾 Save（保存）**
5. 点状态栏的 **Restart（重启）** 生效

### 删除订阅

点击订阅行右侧的 **🗑️** 按钮，确认后删除，记得保存。

> 💡 机场订阅的节点和你手动添加的节点是**完全隔离**的，互不影响。

---

## 13. 管理 DNS 服务器

切换到 **DNS** 标签页，你可以管理不同用途的 DNS 服务器。

> 💡 **什么是 DNS？** 简单来说，DNS 就是帮你把网址（比如 `google.com`）翻译成电脑能理解的数字地址的服务。一般情况下不需要修改此页面的设置。

### DNS 分类说明

| 分类 | 作用 | 什么时候需要改？ |
|------|------|-----------------|
| **Default Nameserver** | 最基础的 DNS，用来解析其他 DNS 服务的地址 | 一般不需要改 |
| **Proxy Server Nameserver** | 专门解析代理服务器地址的 DNS | 一般不需要改 |
| **Direct Nameserver** | 直连流量使用的 DNS | 一般不需要改 |
| **Nameserver** | 主要 DNS，大部分域名依靠它解析 | 想换 DNS 的话改这里 |

### 操作方法

- 每个分类区域右上角有 **+ Add（添加）** 按钮，点击可以添加新的 DNS 地址
- 每行右侧有 **🗑️** 按钮可以删除
- 每行的 **⚡** 按钮可以测试该 DNS 的连通性和速度
- 修改完毕后点 **💾 Save（保存）**，然后点 **Restart（重启）** 生效

### 常用 DNS 地址参考

| DNS 地址 | 说明 |
|---------|------|
| `223.5.5.5` | 阿里 DNS（国内推荐） |
| `119.29.29.29` | 腾讯 DNS（国内推荐） |
| `8.8.8.8` | Google DNS |
| `https://dns.alidns.com/dns-query` | 阿里 DNS 加密版 |
| `https://doh.pub/dns-query` | 腾讯 DNS 加密版 |
| `https://dns.google/dns-query` | Google DNS 加密版 |

---

## 14. 常见问题

### Q: 保存后节点没生效怎么办？

A: 保存配置后，需要点击状态栏的 **Restart（重启）** 按钮，新配置才会真正生效。这是最常被忽略的一步！

### Q: 测速按钮点不了（变灰了）怎么办？

A: 测速需要代理服务处于运行状态（状态栏显示 🟢 绿色）。如果显示红色，先点击 **Start（启动）** 按钮启动服务。

### Q: 导入后显示的节点名称不对？

A: 导入时插件会尽量从你粘贴的内容中提取名称。如果名称不对，可以直接在表格中点击名称栏修改，改完保存即可。

### Q: 绑定了 IP 但设备没走指定节点？

A: 请检查以下几点：
1. 确认 IP 地址填写正确
2. 确认已经点击了**保存**
3. 确认已经点击了**重启**
4. 确认设备的实际 IP 和你填写的一致

### Q: 最多能管理多少个节点？

A: 没有严格限制。实际测试中，200 个以上的节点也能流畅运行。

### Q: 不知道自己的节点信息是什么格式？

A: 不用担心！直接粘贴你拿到的节点信息即可，插件会**自动识别格式**（支持 JSON、YAML、URL、纯文本等多种格式）。如果无法识别，调整一下格式即可——最简单的就是一行一个 `地址:端口` 的写法。

### Q: 机场订阅和手动添加的节点会冲突吗？

A: 不会。机场订阅的节点和你在 Proxies 页面手动添加的节点是**完全隔离**的，各走各的通道，互不影响。

### Q: 换了一台路由器，怎么迁移节点？

A: 在旧路由器上点**导出**按钮下载备份文件，然后在新路由器上安装好插件，用**导入**功能选择备份文件导入即可。

---

> 📝 如果你在使用过程中遇到其他问题，欢迎加入「AI搞钱英雄会」和我们交流（扫描 About 页面的二维码加入）。
